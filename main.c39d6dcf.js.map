{"version":3,"sources":["main.ts","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"main.c39d6dcf.js","sourceRoot":"..","sourcesContent":["const dot = (a, b) => a.map((x, i) => a[i] * b[i]).reduce((m, n) => m + n);\n\nclass Point {\n  x: number;\n  y: number;\n\n  static readonly zero = new Point(0, 0);\n  static readonly unit = new Point(1, 1);\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  rotateAround(center: Point, angle: number): void {\n    const radians = (Math.PI / 180) * angle,\n      cos = Math.cos(radians),\n      sin = Math.sin(radians),\n      nx = cos * (this.x - center.x) + sin * (this.y - center.y) + center.x,\n      ny = cos * (this.y - center.y) - sin * (this.x - center.x) + center.y;\n    this.x = nx;\n    this.y = ny;\n  }\n\n  add(other: Point) {\n    return new Point(this.x + other.x, this.y + other.y);\n  }\n\n  diff(other: Point) {\n    return new Point(other.x - this.x, other.y - this.y);\n  }\n\n  dot(other: Point) {\n    return this.x * other.x + this.y * other.y;\n  }\n\n  multiply(c: number) {\n    return new Point(this.x * c, this.y * c);\n  }\n\n  flipX() {\n    return new Point(-this.x, this.y);\n  }\n\n  flipY() {\n    return new Point(this.x, -this.y);\n  }\n}\n\ninterface Line {\n  a: Point;\n  b: Point;\n}\n\nfunction line_intersects(line1: Line, line2: Line) {\n  const s1_x = line1.b.x - line1.a.x,\n    s1_y = line1.b.y - line1.a.y,\n    s2_x = line2.b.x - line2.a.x,\n    s2_y = line2.b.y - line2.a.y;\n\n  const s =\n      (-s1_y * (line1.a.x - line2.a.x) + s1_x * (line1.a.y - line2.a.y)) /\n      (-s2_x * s1_y + s1_x * s2_y),\n    t =\n      (s2_x * (line1.a.y - line2.a.y) - s2_y * (line1.a.x - line2.a.x)) /\n      (-s2_x * s1_y + s1_x * s2_y);\n\n  return s >= 0 && s <= 1 && t >= 0 && t <= 1;\n}\n\nclass Transform {\n  static nextZInd = 0;\n  position: Point;\n  rotation: number;\n  scale: Point;\n  zInd: number;\n\n  static readonly default = new Transform(Point.zero, 0, Point.unit);\n  static readonly zero = new Transform(Point.zero, 0, Point.zero);\n\n  addPosition(position: Point) {\n    this.add(new Transform(position, 0, Point.zero));\n  }\n\n  addRotation(rotation: number) {\n    this.add(new Transform(Point.zero, rotation, Point.zero));\n    while (this.rotation < 0) {\n      this.add(new Transform(Point.zero, 360, Point.zero));\n    }\n    while (this.rotation >= 360) {\n      this.add(new Transform(Point.zero, -360, Point.zero));\n    }\n  }\n\n  addScale(scale: Point) {\n    const MIN_SCALE = 0.1;\n    this.add(new Transform(Point.zero, 0, scale));\n    if (this.scale.x < MIN_SCALE) {\n      this.add(\n        new Transform(Point.zero, 0, new Point(MIN_SCALE - this.scale.x, 0))\n      );\n    }\n    if (this.scale.y < MIN_SCALE) {\n      this.add(\n        new Transform(Point.zero, 0, new Point(0, MIN_SCALE - this.scale.y))\n      );\n    }\n  }\n\n  add(other: Transform) {\n    this.position = this.position.add(other.position);\n    this.rotation = this.rotation + other.rotation;\n    this.scale = this.scale.add(other.scale);\n  }\n\n  setZInd(newZInd: number) {\n    this.zInd = newZInd;\n  }\n\n  constructor(position: Point, rotation: number, scale: Point, isUI = false) {\n    this.position = position;\n    this.rotation = rotation;\n    this.scale = scale;\n    if (!isUI) {\n      this.zInd = Transform.nextZInd++;\n    }\n  }\n}\n\nabstract class Shape {\n  transform: Transform;\n  selected: boolean;\n\n  constructor(transform: Transform) {\n    this.transform = transform;\n    this.selected = false;\n  }\n\n  abstract getPoints(): Point[];\n  abstract getLines(): Line[];\n  abstract isIntersecting(other: Shape): boolean;\n  abstract isPointInside(point: Point): boolean;\n  abstract draw(ctx: CanvasRenderingContext2D): void;\n  abstract triangulate(): Shape[];\n}\n\nclass Polygon extends Shape {\n  points: Point[];\n  drawPoints: Point[];\n\n  constructor(transform: Transform, points: Point[] = null, normalize = true) {\n    super(transform);\n    this.drawPoints = [];\n    if (points) {\n      if (normalize) {\n        const center = points.reduce(function (\n          prev: Point,\n          curr: Point,\n          _: number,\n          points: Point[]\n        ): Point {\n          return new Point(\n            prev.x + curr.x / points.length,\n            prev.y + curr.y / points.length\n          );\n        },\n        new Point(0, 0));\n        this.points = points.map((p) => center.diff(p).multiply(50));\n      } else {\n        this.points = points;\n      }\n    }\n  }\n\n  draw(ctx: CanvasRenderingContext2D): void {\n    const absoluteTransform = this.transform;\n    this.drawPoints = this.points.map((point) => {\n      const drawPoint = new Point(\n        this.transform.position.x + point.x * absoluteTransform.scale.x,\n        this.transform.position.y + point.y * absoluteTransform.scale.y\n      );\n\n      drawPoint.rotateAround(\n        new Point(absoluteTransform.position.x, absoluteTransform.position.y),\n        this.transform.rotation\n      );\n\n      return drawPoint;\n    });\n\n    const prevStrokeStyle = ctx.strokeStyle;\n    if (this.selected) {\n      ctx.strokeStyle = \"red\";\n    } else {\n      ctx.strokeStyle = \"black\";\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(this.drawPoints[0].x, this.drawPoints[0].y);\n    for (let i = 1; i < this.drawPoints.length; i++) {\n      ctx.lineTo(this.drawPoints[i].x, this.drawPoints[i].y);\n    }\n    ctx.lineTo(this.drawPoints[0].x, this.drawPoints[0].y);\n    ctx.stroke();\n\n    ctx.strokeStyle = prevStrokeStyle;\n  }\n\n  getPoints() {\n    const absoluteTransform = this.transform;\n    this.drawPoints = this.points.map((point) => {\n      const drawPoint = new Point(\n        this.transform.position.x + point.x * absoluteTransform.scale.x,\n        this.transform.position.y + point.y * absoluteTransform.scale.y\n      );\n\n      drawPoint.rotateAround(\n        new Point(absoluteTransform.position.x, absoluteTransform.position.y),\n        this.transform.rotation\n      );\n\n      return drawPoint;\n    });\n    return this.drawPoints;\n  }\n\n  getLines() {\n    const points = this.getPoints();\n    const lines = [];\n    for (let i = 0; i < points.length; i++) {\n      lines.push({ a: points[i], b: points[(i + 1) % points.length] });\n    }\n    return lines;\n  }\n\n  triangulate() {\n    let triangles: Polygon[] = [];\n    const remaining_points = [...this.points];\n    let prev_remaining_points_len = remaining_points.length;\n    while (remaining_points.length > 3) {\n      for (let i = 0; i < remaining_points.length; i++) {\n        const i1 = i == 0 ? remaining_points.length - 1 : i - 1;\n        const i2 = i;\n        const i3 = (i + 1) % remaining_points.length;\n        const p = [\n          remaining_points[i1],\n          remaining_points[i2],\n          remaining_points[i3],\n        ];\n        const angle =\n          Math.atan2(p[2].y - p[1].y, p[2].x - p[1].x) -\n          Math.atan2(p[0].y - p[1].y, p[0].x - p[1].x);\n        if (Math.abs(angle) >= Math.PI) continue;\n        const triangleCandidate = new Polygon(this.transform, p, false);\n        for (let l = 0; l < remaining_points.length; l++) {\n          if (l == i1 || l == i2 || l == i3) continue;\n          if (triangleCandidate.isPointInside(remaining_points[l])) continue;\n        }\n        triangles = triangles.concat(triangleCandidate);\n        remaining_points.splice(i, 1);\n        break;\n      }\n      if (remaining_points.length == prev_remaining_points_len) {\n        break;\n      } else {\n        prev_remaining_points_len = remaining_points.length;\n      }\n    }\n\n    triangles.push(\n      new Polygon(\n        this.transform,\n        [remaining_points[0], remaining_points[1], remaining_points[2]],\n        false\n      )\n    );\n\n    return triangles;\n  }\n\n  isPointInside(point: Point): boolean {\n    const { x, y } = point;\n\n    let inside = false;\n    for (\n      let i = 0, j = this.drawPoints.length - 1;\n      i < this.drawPoints.length;\n      j = i++\n    ) {\n      const xi = this.drawPoints[i].x,\n        yi = this.drawPoints[i].y;\n      const xj = this.drawPoints[j].x,\n        yj = this.drawPoints[j].y;\n\n      const intersect =\n        yi > y != yj > y && x < ((xj - xi) * (y - yi)) / (yj - yi) + xi;\n      if (intersect) inside = !inside;\n    }\n\n    return inside;\n  }\n\n  isIntersecting(other: Shape): boolean {\n    if (!(other instanceof Polygon)) {\n      throw \"Not implemented\";\n    }\n    const polygon: Polygon = other as Polygon;\n    const myLines: Line[] = [];\n    for (let i = 0; i < this.drawPoints.length; i++) {\n      myLines.push({\n        a: this.drawPoints[i],\n        b: this.drawPoints[(i + 1) % this.drawPoints.length],\n      });\n    }\n    const polygonLines: Line[] = [];\n    for (let i = 0; i < polygon.drawPoints.length; i++) {\n      polygonLines.push({\n        a: polygon.drawPoints[i],\n        b: polygon.drawPoints[(i + 1) % polygon.drawPoints.length],\n      });\n    }\n    for (const myLine of myLines) {\n      for (const polygonLine of polygonLines) {\n        if (line_intersects(myLine, polygonLine)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n\nfunction drawLine(a: Point, b: Point, color: string) {\n  const prevStrokeStyle = ctx.strokeStyle;\n  const prevLineWidth = ctx.lineWidth;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 1;\n  ctx.beginPath();\n  ctx.moveTo(a.x, a.y);\n  ctx.lineTo(b.x, b.y);\n  ctx.stroke();\n  ctx.strokeStyle = prevStrokeStyle;\n  ctx.lineWidth = prevLineWidth;\n}\n\nfunction cyrus_beck(line: Line, shape: Shape) {\n  const d = line.b.diff(line.a);\n  const normals = [];\n  const shapePoints = shape.getPoints();\n  for (let i = 0; i < shapePoints.length; i++) {\n    const s = shapePoints[(i + 1) % shapePoints.length];\n    const e = shapePoints[i];\n    const x = e.y - s.y;\n    const y = s.x - e.x;\n    normals.push(new Point(x, y));\n  }\n  let tE = 0;\n  let tL = 1;\n  for (let i = 0; i < shapePoints.length; i++) {\n    const dot_prod = normals[i].dot(d);\n    if (dot_prod != 0) {\n      const diff = line.a.diff(shapePoints[i]);\n      const t = normals[i].dot(diff) / -dot_prod;\n      if (dot_prod < 0) tE = Math.max(tE, t);\n      else tL = Math.min(tL, t);\n    } else {\n      const a = shapePoints[i];\n      const b = shapePoints[(i + 1) % shapePoints.length];\n      const c = line.a;\n      if ((b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x) < 0) {\n        tE = 1;\n        tL = -1;\n      }\n    }\n  }\n\n  if (tE > tL) {\n    return [{ a: line.a, b: line.b }];\n  }\n\n  const p1 = line.a.add(line.a.diff(line.b).multiply(tE));\n  const p2 = line.a.add(line.a.diff(line.b).multiply(tL));\n\n  if (tE == 0 && tL == 1) {\n    return [];\n  }\n  if (tE == 0) {\n    return [{ a: p2, b: line.b }];\n  } else if (tL == 1) {\n    return [{ a: line.a, b: p1 }];\n  } else {\n    return [\n      { a: line.a, b: p1 },\n      { a: p2, b: line.b },\n    ];\n  }\n}\n\nclass Rectangle extends Polygon {\n  constructor(width: number, height: number, transform: Transform) {\n    super(transform);\n    this.points = [];\n    const hWidth: number = width / 2;\n    const hHeight: number = height / 2;\n    this.points.push(new Point(-hWidth, +hHeight));\n    this.points.push(new Point(+hWidth, +hHeight));\n    this.points.push(new Point(+hWidth, -hHeight));\n    this.points.push(new Point(-hWidth, -hHeight));\n  }\n}\n\nclass Button extends Rectangle {\n  static SIZE = 40;\n  glyph: string;\n  clickCallback: (...args: any[]) => void;\n\n  constructor(\n    transform: Transform,\n    glyph: string,\n    clickCallback: (...args: any[]) => void\n  ) {\n    super(Button.SIZE, Button.SIZE, transform);\n    this.glyph = glyph;\n    this.clickCallback = clickCallback;\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    super.draw(ctx);\n    ctx.font = `${Button.SIZE * 0.8}px FontAwesome`;\n    ctx.textBaseline = \"middle\";\n    ctx.textAlign = \"center\";\n\n    ctx.fillText(\n      this.glyph,\n      this.transform.position.x,\n      this.transform.position.y\n    );\n  }\n}\n\nenum Mode {\n  Create,\n  Edit,\n}\n\nenum EditMode {\n  Move,\n  Rotate,\n  Scale,\n  Tabulate\n}\n\nenum CreateMode {\n  Square,\n  Triangle,\n  Arrow,\n  Star,\n}\n\nlet currMode: Mode = Mode.Edit;\nlet currEditMode: EditMode = EditMode.Move;\nlet currCreateMode: CreateMode = CreateMode.Square;\n\nconst canvas = document.querySelector(\"canvas\");\ncanvas.width = 800;\ncanvas.height = 800;\nconst ctx = canvas.getContext(\"2d\");\n\nconst shapes: Shape[] = [];\n\nfunction getSortedShapes() {\n  return shapes.sort((a, b) => b.transform.zInd - a.transform.zInd);\n}\n\nfunction getTopShapeAt(point: Point) {\n  const shapes = getSortedShapes();\n  for (const shape of shapes) {\n    if (shape.isPointInside(point)) {\n      return shape;\n    }\n  }\n  return null;\n}\n\nfunction getButtonAt(point: Point): Button {\n  const btns = buttons;\n  for (const btn of btns) {\n    if (btn.isPointInside(point)) {\n      return btn;\n    }\n  }\n  return null;\n}\n\nfunction setMode(newMode, btn) {\n  if (tabulateCandidate) {\n    tabulateCandidate.selected = false;\n    tabulateCandidate = null;\n  }\n  currMode = newMode;\n  modeButtons.forEach((btn) => (btn.selected = false));\n  btn.selected = true;\n  draw();\n}\n\nconst createButton = new Button(\n  new Transform(new Point(75, 25), 0, Point.unit),\n  \"\\uF0FE\",\n  () => setMode(Mode.Create, createButton)\n);\n\nconst editButton = new Button(\n  new Transform(new Point(25, 25), 0, Point.unit),\n  \"\\uF044\",\n  () => setMode(Mode.Edit, editButton)\n);\neditButton.selected = true;\n\nfunction setEditMode(newMode, btn) {\n  if (tabulateCandidate) {\n    tabulateCandidate.selected = false;\n    tabulateCandidate = null;\n  }\n  currEditMode = newMode;\n  editButtons.forEach((btn) => (btn.selected = false));\n  btn.selected = true;\n  draw();\n}\n\nconst moveButton = new Button(\n  new Transform(new Point(25, 75), 0, Point.unit),\n  \"\\uF047\",\n  () => setEditMode(EditMode.Move, moveButton)\n);\nmoveButton.selected = true;\n\nconst rotateButton = new Button(\n  new Transform(new Point(75, 75), 0, Point.unit),\n  \"\\uF021\",\n  () => setEditMode(EditMode.Rotate, rotateButton)\n);\n\nconst scaleButton = new Button(\n  new Transform(new Point(125, 75), 0, Point.unit),\n  \"\\uF065\",\n  () => setEditMode(EditMode.Scale, scaleButton)\n);\n\nconst tabulateButton = new Button(\n  new Transform(new Point(175, 75), 0, Point.unit),\n  \"\\uF07D\",\n  () => setEditMode(EditMode.Tabulate, tabulateButton)\n);\n\nfunction setCreateMode(newMode, btn) {\n  currCreateMode = newMode;\n  createButtons.forEach((btn) => (btn.selected = false));\n  btn.selected = true;\n  draw();\n}\n\nconst squareButton = new Button(\n  new Transform(new Point(25, 75), 0, Point.unit),\n  \"\\uF0C8\",\n  () => setCreateMode(CreateMode.Square, squareButton)\n);\nsquareButton.selected = true;\n\nconst triangleButton = new Button(\n  new Transform(new Point(75, 75), 0, Point.unit),\n  \"\\uF0D8\",\n  () => setCreateMode(CreateMode.Triangle, triangleButton)\n);\n\nconst arrowButton = new Button(\n  new Transform(new Point(125, 75), 0, Point.unit),\n  \"\\uF124\",\n  () => setCreateMode(CreateMode.Arrow, arrowButton)\n);\n\nconst starButton = new Button(\n  new Transform(new Point(175, 75), 0, Point.unit),\n  \"\\uF005\",\n  () => setCreateMode(CreateMode.Star, starButton)\n);\n\nlet editShape: Shape = null;\nlet editPrevPoint: Point = null;\n\nconst modeButtons = [createButton, editButton];\nconst editButtons = [moveButton, rotateButton, scaleButton, tabulateButton];\nconst createButtons = [squareButton, triangleButton, arrowButton, starButton];\n\nlet buttons = [];\n\n\nlet drawAllLines = false;\n\nfunction switchDrawAllLines()\n{\n  drawAllLines = !drawAllLines;\n  draw();\n}\n\nglobalThis.switchDrawAllLines = switchDrawAllLines;\n\nfunction draw() {\n  ctx.clearRect(0, 0, 800, 800);\n  buttons = modeButtons;\n\n\n  if (currMode == Mode.Create) {\n    buttons = buttons.concat(createButtons);\n  } else {\n    buttons = buttons.concat(editButtons);\n  }\n\n  for (const btn of buttons) {\n    btn.draw(ctx);\n  }\n\n  const shapes = getSortedShapes().reverse();\n  if (shapes.length > 0) {\n    for (let i = 0; i < shapes.length; i++) {\n      let visibleLines = shapes[i].getLines();\n      if (drawAllLines)\n      {\n        for (const visibleLine of visibleLines) {\n          drawLine(visibleLine.a, visibleLine.b, \"green\");\n        }\n      }\n      for (let j = i + 1; j < shapes.length; j++) {\n        const subShapes = shapes[j].triangulate();\n        for (const subShape of subShapes) {\n          let newVisibleLines = [];\n          for (const visible_line of visibleLines) {\n            newVisibleLines = newVisibleLines.concat(\n              cyrus_beck(visible_line, subShape)\n            );\n          }\n          visibleLines = newVisibleLines;\n        }\n      }\n      for (const visibleLine of visibleLines) {\n        drawLine(visibleLine.a, visibleLine.b, shapes[i].selected ? \"red\" : \"black\");\n      }\n    }\n\n\n  }\n}\n\nfunction getMousePos(evt) {\n  const rect = canvas.getBoundingClientRect();\n  return new Point(evt.clientX - rect.left, evt.clientY - rect.top);\n}\n\nlet tabulateCandidate: Shape = null;\n\ncanvas.addEventListener(\"mousedown\", (evt) => {\n  const clickPoint = getMousePos(evt);\n  const clickedButton = getButtonAt(clickPoint);\n  if (clickedButton) {\n    clickedButton.clickCallback();\n  } else {\n    if (currMode == Mode.Edit) {\n      const clickedShape = getTopShapeAt(clickPoint);\n      if (currEditMode == EditMode.Tabulate) {\n        if (clickedShape) {\n        if (tabulateCandidate === null) {\n          tabulateCandidate = clickedShape;\n          tabulateCandidate.selected = true;\n        } else {\n          const tmp = clickedShape.transform.zInd;\n          clickedShape.transform.setZInd(tabulateCandidate.transform.zInd);\n          tabulateCandidate.transform.setZInd(tmp);\n          tabulateCandidate.selected = false;\n          tabulateCandidate = null;\n        }\n      }\n      } else {\n    \n      if (clickedShape) {\n        editShape = clickedShape;\n        editPrevPoint = clickPoint;\n      }\n    }\n    } else {\n      if (clickPoint.x < 200 && clickPoint.y < 100) return; \n      switch (currCreateMode) {\n        case CreateMode.Square:\n          shapes.push(\n            new Polygon(new Transform(clickPoint, 0, Point.unit), [\n              new Point(1, -1),\n              new Point(1, 1),\n              new Point(-1, 1),\n              new Point(-1, -1),\n            ])\n          );\n          break;\n        case CreateMode.Triangle:\n          shapes.push(\n            new Polygon(new Transform(clickPoint, 0, Point.unit), [\n              new Point(1, 1),\n              new Point(-1, 1),\n              new Point(0, -1),\n            ])\n          );\n          break;\n        case CreateMode.Arrow:\n          shapes.push(\n            new Polygon(new Transform(clickPoint, 0, Point.unit), [\n              new Point(0, -1),\n              new Point(2, -2),\n              new Point(1, 0),\n              new Point(1, -1),\n            ])\n          );\n          break;\n        case CreateMode.Star:\n          shapes.push(\n            new Polygon(\n              new Transform(clickPoint, 0, Point.unit),\n              [\n                new Point(0, -2.5),\n                new Point(0.9, -0.5),\n                new Point(3, -0.5),\n                new Point(1.35, 0.5),\n                new Point(2.25, 2.5),\n                new Point(0, 1.5),\n                new Point(-2.25, 2.5),\n                new Point(-1.35, 0.5),\n                new Point(-3, -0.5),\n                new Point(-0.9, -0.5),\n              ].map((p) => p.multiply(0.5))\n            )\n          );\n          break;\n      }\n    }\n    draw();\n  }\n});\n\ncanvas.addEventListener(\"mouseup\", () => {\n  editShape = null;\n  editPrevPoint = null;\n});\n\ncanvas.addEventListener(\"mouseleave\", () => {\n  editShape = null;\n  editPrevPoint = null;\n});\n\ncanvas.addEventListener(\"mousemove\", (evt) => {\n  if (editShape) {\n    const currPoint = getMousePos(evt);\n    const editDiff = editPrevPoint.diff(currPoint);\n    editPrevPoint = currPoint;\n    switch (currEditMode) {\n      case EditMode.Move:\n        editShape.transform.addPosition(editDiff);\n        break;\n      case EditMode.Rotate:\n        editShape.transform.addRotation(editDiff.y);\n        break;\n      case EditMode.Scale:\n        editShape.transform.addScale(editDiff.multiply(0.01).flipY());\n        break;\n    }\n    draw();\n  }\n});\n\ndraw();\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}